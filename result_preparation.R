install.packages("libr")
install.packages("stringr")
library(dplyr)
library(tidyr)
library(stringr)
library(tidyverse)

#load and shape datasets
german <- read.csv("allinone_de.csv", sep="\t")
german$Tags <- NULL
english <- read.csv("allinone_en.csv", sep="\t")
english$Tags <- NULL

reshaped_de <- select(german, Text_Title, Feature_id, Value)
reshaped_de <- pivot_wider(reshaped_de, names_from = Text_Title, values_from = Value)

reshaped_en <- select(english, Text_Title, Feature_id, Value)
reshaped_en <- pivot_wider(reshaped_en, names_from = Text_Title, values_from = Value)

#find the common features in the analysis and put them into columns
red_english <- semi_join(reshaped_en, reshaped_de, by="Feature_id")
red_german <- semi_join(reshaped_de, reshaped_en, by="Feature_id")

red_english1 <- column_to_rownames(red_english, var="Feature_id")
red_english1 <- red_english1[order(as.numeric(row.names(red_english1))),]
red_english1 <- t(red_english1)

red_german1 <- column_to_rownames(red_german, var="Feature_id")
red_german1 <- red_german1[order(as.numeric(row.names(red_german1))),]
red_german1 <- t(red_german1)

#find and exclude features or texts with NaN Values
NA_vars_de <- as.data.frame(which(is.na(red_german1), arr.ind=TRUE))
NA_vars_en <- as.data.frame(which(is.na(red_english1), arr.ind=TRUE))

'NA_indices_de <- unique(NA_vars_de[2])'
'NA_indices <- union(NA_indices_de,NA_indices_en)'

red_english2 <- red_english1[-NA_vars_en$row,]
red_german2 <- red_german1[-NA_vars_de$row,]

#find and exclude features with SD = 0
no_SD_de <- as.data.frame(which(apply(red_german2, 2, sd)==0, arr.ind = TRUE))
no_SD_en <- as.data.frame(which(apply(red_english2, 2, sd)==0, arr.ind = TRUE))
colnames(no_SD_de) <- 'col'
colnames(no_SD_en) <- 'col'
no_SD_indices <- union(no_SD_de,no_SD_en)

red_english3 <- red_english2[,-no_SD_indices$col]
red_german3 <- red_german2[,-no_SD_indices$col]

red_german_rubbish <- c('de_84.txt','de_208.txt','de_247.txt','de_155.txt',
                           'de_335.txt','de_340.txt','de_349.txt','de_357.txt',
                           'de_673.txt','de_948.txt','de_50.txt','de_51.txt',
                           'de_241.txt','de_257.txt','de_383.txt','de_394.txt',
                           'de_594.txt','de_567.txt','de_887.txt','de_841.txt',
                           'de_857.txt','de_899.txt','de_915.txt','de_932.txt',
                           'de_88.txt','de_105.txt','de_206.txt','de_223.txt',
                           'de_225.txt','de_230.txt','de_233.txt','de_249.txt',
                           'de_254.txt','de_301.txt','de_802.txt')

red_german3 <- red_german3[is.na(match(row.names(red_german3),red_german_rubbish)),]

#splitting features into groups by linguistic levels
syntactic_en<- subset(red_english3, select = c('90','91','101','142','160',
                                                 '186','196','199','240','281',
                                                 '289','293','327','343','344',
                                                 '353','360','362','384','403',
                                                 '447','449','484','503','523',
                                                 '527','539','542','555','562',
                                                 '564','565','567','573','577',
                                                 '603','605','642','648','654',
                                                 '719','759','767','784','810',
                                                 '828','833','845','847','849',
                                                 '850','853','873','884','900',
                                                 '905','918','959','987','1002',
                                                 '1008','1010','1012','1035',
                                                 '1041','1042','1046','1049',
                                                 '1063','1072','1109','1114'))

syntactic_de <- subset(red_german3, select = c('90','91','101','142','160',
                                                '186','196','199','240','281',
                                                '289','293','327','343','344',
                                                '353','360','362','384','403',
                                                '447','449','484','503','523',
                                                '527','539','542','555','562',
                                                '564','565','567','573','577',
                                                '603','605','642','648','654',
                                                '719','759','767','784','810',
                                                '828','833','845','847','849',
                                                '850','853','873','884','900',
                                                '905','918','959','987','1002',
                                                '1008','1010','1012','1035',
                                                '1041','1042','1046','1049',
                                                '1063','1072','1109','1114'))

lexical_en <- subset(red_english3, select = c('13','18','22','39','41','44',
                                               '47','54','60','80','92',
                                               '98','102','125','138',
                                               '154','158','166','173','177',
                                               '183','184','193',
                                               '215','216','225','250','256',
                                               '274','275','298','306','322',
                                               '349','350','356','361',
                                               '368','382','401','405','407',
                                               '421','427','428','446',
                                               '451','454','462','463','486',
                                               '488','491','501','514','521',
                                               '531','535','549','556','574',
                                               '611','636','643','653',
                                               '656','661','665','674','675',
                                               '676','690','692','695','697',
                                               '700','701','704','715','724',
                                               '729','740','743','747','753',
                                               '754','764','768','780',
                                               '783','785','795','802','805',
                                               '813','826','854','855','858',
                                               '862','866','882','886','890',
                                               '891','902','910','922','936',
                                               '956','958','972','990','1004',
                                               '1016','1027','1038','1039',
                                               '1045','1051','1058','1069',
                                               '1074','1081','1099','1102',
                                               '1113'))

lexical_de <- subset(red_german3, select = c('13','18','22','39','41','44',
                                             '47','54','60','80','92',
                                             '98','102','125','138',
                                             '154','158','166','173','177',
                                             '183','184','193',
                                             '215','216','225','250','256',
                                             '274','275','298','306','322',
                                             '349','350','356','361',
                                             '368','382','401','405','407',
                                             '421','427','428','446',
                                             '451','454','462','463','486',
                                             '488','491','501','514','521',
                                             '531','535','549','556','574',
                                             '611','636','643','653',
                                             '656','661','665','674','675',
                                             '676','690','692','695','697',
                                             '700','701','704','715','724',
                                             '729','740','743','747','753',
                                             '754','764','768','780',
                                             '783','785','795','802','805',
                                             '813','826','854','855','858',
                                             '862','866','882','886','890',
                                             '891','902','910','922','936',
                                             '956','958','972','990','1004',
                                             '1016','1027','1038','1039',
                                             '1045','1051','1058','1069',
                                             '1074','1081','1099','1102',
                                             '1113'))

language_use_en <- subset(red_english3, select = c('34','35','51','64','67',
                                                    '70','75','86','103','104',
                                                    '128','157','169','185',
                                                    '194','203','207','218',
                                                    '227','234','247','252',
                                                    '254','264','270','273',
                                                    '279','282','296','302',
                                                    '307','315','324','334',
                                                    '345','352','390','395',
                                                    '396','409','422','430',
                                                    '433','442','448','459',
                                                    '460','466','473','483',
                                                    '499','502','508','519',
                                                    '520','532','545','568',
                                                    '570','597','606','612',
                                                    '620','623','626','641',
                                                    '651','659','668','696',
                                                    '703','723','726','730',
                                                    '737','765','773','779',
                                                    '789','790','806','817',
                                                    '822','834','836','840',
                                                    '870','874','878','895',
                                                    '896','909','913','926',
                                                    '945','951','979','980',
                                                    '1017','1036','1056','1061',
                                                    '1082','1104','1107','1111'))

language_use_de <- subset(red_german3, select = c('34','35','51','64','67',
                                                   '70','75','86','103','104',
                                                   '128','157','169','185',
                                                   '194','203','207','218',
                                                   '227','234','247','252',
                                                   '254','264','270','273',
                                                   '279','282','296','302',
                                                   '307','315','324','334',
                                                   '345','352','390','395',
                                                   '396','409','422','430',
                                                   '433','442','448','459',
                                                   '460','466','473','483',
                                                   '499','502','508','519',
                                                   '520','532','545','568',
                                                   '570','597','606','612',
                                                   '620','623','626','641',
                                                   '651','659','668','696',
                                                   '703','723','726','730',
                                                   '737','765','773','779',
                                                   '789','790','806','817',
                                                   '822','834','836','840',
                                                   '870','874','878','895',
                                                   '896','909','913','926',
                                                   '945','951','979','980',
                                                   '1017','1036','1056','1061',
                                                   '1082','1104','1107','1111'))

morphological_en <- subset(red_english3, select = c('660','756'))

morphological_de <- subset(red_german3, select = c('660','756'))

discourse_en <- subset(red_english3, select = c('27','30','94','163','179',
                                                 '261','294','305','340','365',
                                                 '417','500','526','560','566',
                                                 '681','705','796','835','848',
                                                 '940','943','955','1015','1022',
                                                 '1025'))

discourse_de <- subset(red_german3, select = c('27','30','94','163','179',
                                                '261','294','305','340','365',
                                                '417','500','526','560','566',
                                                '681','705','796','835','848',
                                                '940','943','955','1015','1022',
                                                '1025'))

processing_en <- subset(red_english3, select = c('148','301','477','547','733',
                                                  '952','982','991','1047'))

processing_de <- subset(red_german3, select = c('148','301','477','547','733',
                                                 '952','982','991','1047'))
length_de <- subset(red_german3, select = c('101','142','160','186','196','293',
                                            '327','343','344','484','503','523',
                                            '527','564','565','577','648','719',
                                            '784','833','847','849','850','873',
                                            '905','959','987','1012','1041','1109',
                                            '1114','18','22','138','177','183',
                                            '193','256','274','306','361','368',
                                            '428','454','462','463','491','521',
                                            '531','574','636','656','665','676',
                                            '692','697','704','729','740','747',
                                            '754','764','785','826','854',
                                            '855','858','902','922','936','956',
                                            '972','1038','1058','1081'))

length_en <- subset(red_english3, select = c('101','142','160','186','196','293',
                                             '327','343','344','484','503','523',
                                             '527','564','565','577','648','719',
                                             '784','833','847','849','850','873',
                                             '905','959','987','1012','1041','1109',
                                             '1114','18','22','138','177','183',
                                             '193','256','274','306','361','368',
                                             '428','454','462','463','491','521',
                                             '531','574','636','656','665','676',
                                             '692','697','704','729','740','747',
                                             '754','764','785','826','854',
                                             '855','858','902','922','936','956',
                                             '972','1038','1058','1081'))
#z-transform given dataframes
red_english3_z <- scale(red_english3)
red_german3_z <- scale(red_german3)

syntactic_en_z <- scale(syntactic_en)
syntactic_de_z <- scale(syntactic_de)
lexical_en_z <- scale(lexical_en)
lexical_de_z <- scale(lexical_de)
language_use_en_z <- scale(language_use_en)
language_use_de_z <- scale(language_use_de)
morphological_en_z <- scale(morphological_en)
morphological_de_z <- scale(morphological_de)
discourse_en_z <- scale(discourse_en)
discourse_de_z <- scale(discourse_de)
processing_en_z <- scale(processing_en)
processing_de_z <- scale(processing_de)
length_de_z <- scale(length_de)
length_en_z <- scale(length_en)
